!function(){"use strict";var n=(t.prototype.hasString=function(t){return this.strings.hasOwnProperty(t)},t.prototype.load=function(e){var i=this;!function(t,e){var i=new XMLHttpRequest;i.onload=function(){this.status<300&&200<=this.status&&e&&e(i.responseText)},i.open("GET",t,!0),i.send()}(this.url,function(t){i.strings=JSON.parse(t),e&&e()})},t);function t(t,e){void 0===e&&(e={}),this.url=t,this.strings=e}function e(t){var e=new Date;e.setTime(e.getTime()+31536e7);var i="; expires="+e.toUTCString();document.cookie="vavilon-locale="+(t||"")+i+"; path=/"}function i(){return(function(){var t=("; "+document.cookie).split("; vavilon-locale=");return 2===t.length?t[1].split(";")[0]:null}()||window.navigator.language||window.browserLanguage||window.userLanguage).toLowerCase()}function o(){this.userLocale=i(),this.pageLocale=document.documentElement.lang.toLowerCase(),this.elements=null,this.dictionaries={},this.pageDict=null}var a=new(o.prototype.findAllElements=function(){this.elements=document.getElementsByClassName("vavilon")},o.prototype.replaceAllElements=function(){var i=this;this.elements&&this.pageDict&&(this.dictionaries[this.pageLocale]||(this.dictionaries[this.pageLocale]=new n(null)),Array.from(this.elements).forEach(function(t){var e=t.dataset.vavilon;i.dictionaries[i.pageDict].hasString(e)&&(i.dictionaries[i.pageLocale].hasString(e)||(i.dictionaries[i.pageLocale].strings[e]=t.innerText),t.innerText=i.dictionaries[i.pageDict].strings[e])}))},o.prototype.registerDictionaries=function(){var i=this;Array.from(document.scripts).filter(function(t){return t.dataset.hasOwnProperty("vavilonDict")}).forEach(function(t){var e=t.dataset.vavilonDict.toLowerCase();i.dictionaries[e]=new n(t.src)})},o.prototype.loadDictionaries=function(e){var i=this;Object.keys(this.dictionaries).forEach(function(t){t===i.userLocale||t.slice(0,2)===i.userLocale.slice(0,2)&&!i.pageDict?(i.pageDict=t,i.dictionaries[t].load(function(){i.pageDictLoaded=!0,e()})):i.dictionaries[t].load()})},o.prototype.changeLocale=function(t){return this.dictionaries[t]?(this.pageDict=t,e(this.pageDict),!0):!!this.dictionaries[t.slice(0,2)]&&(this.pageDict=t.slice(0,2),e(this.pageDict),!0)},o),s=!1;a.registerDictionaries(),a.loadDictionaries(function(){s&&a.replaceAllElements()}),window.onload=function(){a.findAllElements(),s=!0,a.pageDictLoaded&&a.replaceAllElements()},window.setLang=function(t){t=t.toLowerCase(),a.changeLocale(t)&&a.replaceAllElements()}}();
